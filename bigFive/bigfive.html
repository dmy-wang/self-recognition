<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>å¤§äº”äººæ ¼æµ‹è¯• | BFI-44</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        :root {
            --primary: #ff2442;
            --primary-light: #ff6b81;
            --secondary: #ffeef0;
            --bg: #fafafa;
            --card: #ffffff;
            --text: #333333;
            --text-light: #666666;
            --border: #f0f0f0;
            --shadow: 0 2px 12px rgba(0,0,0,0.08);
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'PingFang SC', 'Hiragino Sans GB', 'Microsoft YaHei', sans-serif;
            background: var(--bg);
            color: var(--text);
            line-height: 1.6;
            min-height: 100vh;
        }

        .container {
            max-width: 680px;
            margin: 0 auto;
            padding: 20px;
        }

        .header {
            text-align: center;
            padding: 40px 20px;
            background: linear-gradient(135deg, var(--primary) 0%, var(--primary-light) 100%);
            border-radius: 0 0 30px 30px;
            color: white;
            margin: -20px -20px 30px -20px;
        }

        .header h1 { font-size: 28px; font-weight: 600; margin-bottom: 8px; }
        .header p { font-size: 14px; opacity: 0.9; }

        .progress-container {
            background: var(--card);
            border-radius: 16px;
            padding: 20px;
            margin-bottom: 20px;
            box-shadow: var(--shadow);
        }

        .progress-bar {
            height: 8px;
            background: var(--border);
            border-radius: 4px;
            overflow: hidden;
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, var(--primary) 0%, var(--primary-light) 100%);
            border-radius: 4px;
            transition: width 0.3s ease;
        }

        .progress-text {
            display: flex;
            justify-content: space-between;
            margin-top: 10px;
            font-size: 13px;
            color: var(--text-light);
        }

        .question-card {
            background: var(--card);
            border-radius: 20px;
            padding: 30px;
            box-shadow: var(--shadow);
            margin-bottom: 20px;
        }

        .question-number {
            display: inline-block;
            background: var(--secondary);
            color: var(--primary);
            padding: 4px 12px;
            border-radius: 20px;
            font-size: 13px;
            font-weight: 500;
            margin-bottom: 16px;
        }

        .question-text {
            font-size: 18px;
            font-weight: 500;
            margin-bottom: 24px;
            line-height: 1.5;
        }

        .question-prefix {
            color: var(--text-light);
            font-size: 14px;
            margin-bottom: 8px;
        }

        .options {
            display: flex;
            flex-direction: column;
            gap: 12px;
        }

        .option {
            display: flex;
            align-items: center;
            padding: 16px 20px;
            background: var(--bg);
            border: 2px solid transparent;
            border-radius: 12px;
            cursor: pointer;
            transition: all 0.2s ease;
        }

        .option:hover {
            background: var(--secondary);
            border-color: var(--primary-light);
        }

        .option.selected {
            background: var(--secondary);
            border-color: var(--primary);
        }

        .option-radio {
            width: 22px;
            height: 22px;
            border: 2px solid #ddd;
            border-radius: 50%;
            margin-right: 14px;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.2s ease;
        }

        .option.selected .option-radio {
            border-color: var(--primary);
            background: var(--primary);
        }

        .option.selected .option-radio::after {
            content: '';
            width: 8px;
            height: 8px;
            background: white;
            border-radius: 50%;
        }

        .option-text { font-size: 15px; }

        .nav-buttons {
            display: flex;
            gap: 12px;
            margin-top: 20px;
        }

        .btn {
            flex: 1;
            padding: 16px 24px;
            border: none;
            border-radius: 12px;
            font-size: 16px;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.2s ease;
        }

        .btn-secondary {
            background: var(--border);
            color: var(--text-light);
        }

        .btn-secondary:hover { background: #e5e5e5; }

        .btn-primary {
            background: linear-gradient(135deg, var(--primary) 0%, var(--primary-light) 100%);
            color: white;
        }

        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 15px rgba(255, 36, 66, 0.3);
        }

        .btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
            transform: none;
        }

        .results-header {
            text-align: center;
            padding: 30px;
            background: var(--card);
            border-radius: 20px;
            box-shadow: var(--shadow);
            margin-bottom: 20px;
        }

        .results-header h2 { font-size: 24px; margin-bottom: 8px; }
        .results-header p { color: var(--text-light); font-size: 14px; }
        .results-date { font-size: 12px; color: var(--text-light); margin-top: 12px; }

        .dimension-card {
            background: var(--card);
            border-radius: 20px;
            padding: 24px;
            box-shadow: var(--shadow);
            margin-bottom: 16px;
        }

        .dimension-header {
            display: flex;
            align-items: center;
            margin-bottom: 16px;
        }

        .dimension-icon {
            width: 48px;
            height: 48px;
            border-radius: 14px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 24px;
            margin-right: 14px;
        }

        .dimension-icon.O { background: #e8f5e9; }
        .dimension-icon.C { background: #fff3e0; }
        .dimension-icon.E { background: #fce4ec; }
        .dimension-icon.A { background: #e3f2fd; }
        .dimension-icon.N { background: #f3e5f5; }

        .dimension-title h3 { font-size: 18px; margin-bottom: 2px; }
        .dimension-title span { font-size: 13px; color: var(--text-light); }

        .dimension-score { margin-left: auto; text-align: right; }
        .score-value { font-size: 28px; font-weight: 600; color: var(--primary); }
        .score-label { font-size: 12px; color: var(--text-light); }

        .score-bar {
            height: 10px;
            background: var(--border);
            border-radius: 5px;
            margin-bottom: 16px;
            overflow: hidden;
        }

        .score-fill {
            height: 100%;
            border-radius: 5px;
            transition: width 0.5s ease;
        }

        .score-fill.O { background: linear-gradient(90deg, #66bb6a, #43a047); }
        .score-fill.C { background: linear-gradient(90deg, #ffb74d, #ff9800); }
        .score-fill.E { background: linear-gradient(90deg, #f48fb1, #e91e63); }
        .score-fill.A { background: linear-gradient(90deg, #64b5f6, #2196f3); }
        .score-fill.N { background: linear-gradient(90deg, #ba68c8, #9c27b0); }

        .dimension-level {
            display: inline-block;
            padding: 4px 12px;
            border-radius: 20px;
            font-size: 13px;
            font-weight: 500;
            margin-bottom: 12px;
        }

        .level-high { background: #e8f5e9; color: #2e7d32; }
        .level-medium { background: #fff3e0; color: #ef6c00; }
        .level-low { background: #fce4ec; color: #c2185b; }

        .dimension-desc {
            font-size: 14px;
            color: var(--text-light);
            line-height: 1.7;
            margin-bottom: 16px;
        }

        .analysis-section {
            background: var(--bg);
            border-radius: 12px;
            padding: 16px;
            margin-top: 12px;
        }

        .analysis-title {
            font-size: 14px;
            font-weight: 600;
            margin-bottom: 8px;
            display: flex;
            align-items: center;
            gap: 6px;
        }

        .analysis-content {
            font-size: 13px;
            color: var(--text-light);
            line-height: 1.6;
        }

        .analysis-tags {
            display: flex;
            flex-wrap: wrap;
            gap: 8px;
            margin-top: 8px;
        }

        .tag {
            padding: 4px 10px;
            background: white;
            border-radius: 6px;
            font-size: 12px;
            color: var(--text);
        }

        .summary-card {
            background: linear-gradient(135deg, var(--primary) 0%, var(--primary-light) 100%);
            border-radius: 20px;
            padding: 24px;
            color: white;
            margin-bottom: 16px;
        }

        .summary-card h3 { font-size: 18px; margin-bottom: 16px; }

        .summary-item {
            display: flex;
            align-items: center;
            padding: 12px 0;
            border-bottom: 1px solid rgba(255,255,255,0.2);
        }

        .summary-item:last-child { border-bottom: none; }
        .summary-icon { font-size: 20px; margin-right: 12px; }
        .summary-text { flex: 1; }
        .summary-label { font-size: 12px; opacity: 0.8; }
        .summary-value { font-size: 15px; font-weight: 500; }

        .action-buttons {
            display: flex;
            gap: 12px;
            margin-top: 20px;
            margin-bottom: 30px;
        }

        .btn-outline {
            flex: 1;
            padding: 14px 20px;
            background: white;
            border: 2px solid var(--primary);
            color: var(--primary);
            border-radius: 12px;
            font-size: 15px;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.2s ease;
        }

        .btn-outline:hover { background: var(--secondary); }

        .history-card {
            background: var(--card);
            border-radius: 20px;
            padding: 24px;
            box-shadow: var(--shadow);
            margin-bottom: 20px;
        }

        .history-card h3 {
            font-size: 16px;
            margin-bottom: 16px;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .history-item {
            display: flex;
            align-items: center;
            padding: 12px;
            background: var(--bg);
            border-radius: 10px;
            margin-bottom: 8px;
            cursor: pointer;
            transition: all 0.2s ease;
        }

        .history-item:hover { background: var(--secondary); }
        .history-item:last-child { margin-bottom: 0; }
        .history-date { font-size: 14px; font-weight: 500; }
        .history-preview { font-size: 12px; color: var(--text-light); margin-top: 2px; }
        .history-arrow { margin-left: auto; color: var(--text-light); }

        .welcome-card {
            background: var(--card);
            border-radius: 20px;
            padding: 30px;
            box-shadow: var(--shadow);
            text-align: center;
        }

        .welcome-icon { font-size: 64px; margin-bottom: 20px; }
        .welcome-card h2 { font-size: 22px; margin-bottom: 12px; }
        .welcome-card p { color: var(--text-light); font-size: 14px; margin-bottom: 24px; line-height: 1.7; }

        .welcome-features {
            display: flex;
            flex-direction: column;
            gap: 12px;
            margin-bottom: 24px;
            text-align: left;
        }

        .feature-item {
            display: flex;
            align-items: center;
            gap: 12px;
            padding: 12px;
            background: var(--bg);
            border-radius: 10px;
        }

        .feature-icon { font-size: 20px; }
        .feature-text { font-size: 14px; }

        @media (max-width: 480px) {
            .container { padding: 16px; }
            .header { padding: 30px 16px; margin: -16px -16px 20px -16px; }
            .header h1 { font-size: 24px; }
            .question-card { padding: 24px 20px; }
            .question-text { font-size: 16px; }
            .option { padding: 14px 16px; }
            .dimension-card { padding: 20px; }
            .score-value { font-size: 24px; }
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .fade-in { animation: fadeIn 0.3s ease; }
        .hidden { display: none !important; }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>ğŸ§  å¤§äº”äººæ ¼æµ‹è¯•</h1>
            <p>BFI-44 ç§‘å­¦äººæ ¼è¯„ä¼° Â· çº¦8åˆ†é’Ÿå®Œæˆ</p>
        </div>

        <div id="welcomeContainer">
            <div class="welcome-card">
                <div class="welcome-icon">ğŸ¯</div>
                <h2>æ¢ç´¢çœŸå®çš„è‡ªå·±</h2>
                <p>å¤§äº”äººæ ¼æ¨¡å‹æ˜¯å¿ƒç†å­¦ç•Œå…¬è®¤æœ€å¯é çš„äººæ ¼ç†è®ºï¼Œé€šè¿‡44é“é¢˜ç›®ï¼Œç§‘å­¦è¯„ä¼°ä½ çš„äº”ä¸ªæ ¸å¿ƒäººæ ¼ç»´åº¦ã€‚</p>
                
                <div class="welcome-features">
                    <div class="feature-item">
                        <span class="feature-icon">ğŸ“Š</span>
                        <span class="feature-text">äº”ç»´åº¦æ·±åº¦åˆ†ææŠ¥å‘Š</span>
                    </div>
                    <div class="feature-item">
                        <span class="feature-icon">ğŸ’¼</span>
                        <span class="feature-text">èŒä¸šå‘å±•å»ºè®®</span>
                    </div>
                    <div class="feature-item">
                        <span class="feature-icon">ğŸ’•</span>
                        <span class="feature-text">å©šæ‹å…³ç³»æ´å¯Ÿ</span>
                    </div>
                    <div class="feature-item">
                        <span class="feature-icon">ğŸ“</span>
                        <span class="feature-text">ä¸ªäººæˆé•¿æŒ‡å—</span>
                    </div>
                </div>

                <button class="btn btn-primary" onclick="startTest()" style="width: 100%;">å¼€å§‹æµ‹è¯•</button>
            </div>

            <div class="history-card" id="historyCard" style="display: none;">
                <h3>ğŸ“‹ å†å²è®°å½•</h3>
                <div id="historyList"></div>
            </div>
        </div>

        <div id="testContainer" style="display: none;">
            <div class="progress-container">
                <div class="progress-bar">
                    <div class="progress-fill" id="progressFill" style="width: 0%"></div>
                </div>
                <div class="progress-text">
                    <span id="progressText">ç¬¬ 1 é¢˜ / å…± 44 é¢˜</span>
                    <span id="progressPercent">0%</span>
                </div>
            </div>

            <div class="question-card fade-in" id="questionCard">
                <span class="question-number" id="questionNumber">Q1</span>
                <p class="question-prefix">æˆ‘è®¤ä¸ºè‡ªå·±æ˜¯ä¸€ä¸ª...</p>
                <p class="question-text" id="questionText"></p>
                
                <div class="options" id="optionsContainer">
                    <div class="option" data-value="1" onclick="selectOption(this)">
                        <div class="option-radio"></div>
                        <span class="option-text">éå¸¸ä¸åŒæ„</span>
                    </div>
                    <div class="option" data-value="2" onclick="selectOption(this)">
                        <div class="option-radio"></div>
                        <span class="option-text">æ¯”è¾ƒä¸åŒæ„</span>
                    </div>
                    <div class="option" data-value="3" onclick="selectOption(this)">
                        <div class="option-radio"></div>
                        <span class="option-text">ä¸­ç«‹</span>
                    </div>
                    <div class="option" data-value="4" onclick="selectOption(this)">
                        <div class="option-radio"></div>
                        <span class="option-text">æ¯”è¾ƒåŒæ„</span>
                    </div>
                    <div class="option" data-value="5" onclick="selectOption(this)">
                        <div class="option-radio"></div>
                        <span class="option-text">éå¸¸åŒæ„</span>
                    </div>
                </div>
            </div>

            <div class="nav-buttons">
                <button class="btn btn-secondary" id="prevBtn" onclick="prevQuestion()" disabled>ä¸Šä¸€é¢˜</button>
                <button class="btn btn-primary" id="nextBtn" onclick="nextQuestion()" disabled>ä¸‹ä¸€é¢˜</button>
            </div>
        </div>

        <div id="resultsContainer" style="display: none;"></div>
    </div>

    <script>
        // ========== å¯†ç éªŒè¯ ==========
        const ACCESS_PASSWORD = "test2024";  // æ”¹æˆä½ æƒ³è¦çš„å¯†ç 

        (function() {
            const saved = localStorage.getItem('personality_test_access');
            if (saved === ACCESS_PASSWORD) return;
            
            const input = prompt('è¯·è¾“å…¥è®¿é—®å¯†ç ï¼š');
            if (input === ACCESS_PASSWORD) {
                localStorage.setItem('personality_test_access', input);
            } else {
                document.body.innerHTML = `
                    <div style="display:flex;justify-content:center;align-items:center;height:100vh;font-family:sans-serif;">
                        <div style="text-align:center;padding:40px;">
                            <h2 style="color:#333;">å¯†ç é”™è¯¯</h2>
                            <p style="color:#666;">è¯·è”ç³»å–å®¶è·å–æ­£ç¡®å¯†ç </p>
                            <button onclick="location.reload()" style="margin-top:20px;padding:10px 20px;cursor:pointer;">é‡æ–°è¾“å…¥</button>
                        </div>
                    </div>
                `;
                throw new Error('Access denied');
            }
        })();
        // ========== å¯†ç éªŒè¯ç»“æŸ ==========

        const questions = [
            { id: 1, text: "å¥è°ˆçš„äºº", dimension: "E", reverse: false },
            { id: 2, text: "å®¹æ˜“æŒ‘å‰”åˆ«äººæ¯›ç—…çš„äºº", dimension: "A", reverse: true },
            { id: 3, text: "åšäº‹å½»åº•ã€ä¸é©¬è™çš„äºº", dimension: "C", reverse: false },
            { id: 4, text: "æƒ…ç»ªä½è½ã€å¿§éƒçš„äºº", dimension: "N", reverse: false },
            { id: 5, text: "æœ‰ç‹¬åˆ›æ€§ã€èƒ½æå‡ºæ–°æƒ³æ³•çš„äºº", dimension: "O", reverse: false },
            { id: 6, text: "å†…å‘ã€æ²‰é»˜å¯¡è¨€çš„äºº", dimension: "E", reverse: true },
            { id: 7, text: "ä¹äºåŠ©äººã€å¯¹äººæ— ç§çš„äºº", dimension: "A", reverse: false },
            { id: 8, text: "æœ‰æ—¶ç²—å¿ƒå¤§æ„çš„äºº", dimension: "C", reverse: true },
            { id: 9, text: "æ”¾æ¾ã€èƒ½å¾ˆå¥½åº”å¯¹å‹åŠ›çš„äºº", dimension: "N", reverse: true },
            { id: 10, text: "å¯¹å¾ˆå¤šä¸åŒäº‹ç‰©æ„Ÿåˆ°å¥½å¥‡çš„äºº", dimension: "O", reverse: false },
            { id: 11, text: "å……æ»¡æ´»åŠ›çš„äºº", dimension: "E", reverse: false },
            { id: 12, text: "å®¹æ˜“ä¸äººå‘ç”Ÿäº‰æ‰§çš„äºº", dimension: "A", reverse: true },
            { id: 13, text: "å·¥ä½œå¯é çš„äºº", dimension: "C", reverse: false },
            { id: 14, text: "å¯èƒ½ä¼šç´§å¼ çš„äºº", dimension: "N", reverse: false },
            { id: 15, text: "æ€ç»´æ•æ·ã€æœ‰æ·±åº¦çš„äºº", dimension: "O", reverse: false },
            { id: 16, text: "èƒ½å¸¦åŠ¨å¾ˆå¤šçƒ­æƒ…çš„äºº", dimension: "E", reverse: false },
            { id: 17, text: "å®½å®¹çš„äºº", dimension: "A", reverse: false },
            { id: 18, text: "åšäº‹å®¹æ˜“æ‚ä¹±æ— ç« çš„äºº", dimension: "C", reverse: true },
            { id: 19, text: "å¾ˆå°‘æ‹…å¿§çš„äºº", dimension: "N", reverse: true },
            { id: 20, text: "æƒ³è±¡åŠ›ä¸°å¯Œçš„äºº", dimension: "O", reverse: false },
            { id: 21, text: "æ¯”è¾ƒå®‰é™çš„äºº", dimension: "E", reverse: true },
            { id: 22, text: "é€šå¸¸ä¿¡ä»»ä»–äººçš„äºº", dimension: "A", reverse: false },
            { id: 23, text: "å€¾å‘äºæ‡’æƒ°çš„äºº", dimension: "C", reverse: true },
            { id: 24, text: "æƒ…ç»ªç¨³å®šã€ä¸å®¹æ˜“å¿ƒçƒ¦æ„ä¹±çš„äºº", dimension: "N", reverse: true },
            { id: 25, text: "æœ‰åˆ›é€ åŠ›çš„äºº", dimension: "O", reverse: false },
            { id: 26, text: "æœ‰ä¸»è§ã€å–„äºè¡¨è¾¾çš„äºº", dimension: "E", reverse: false },
            { id: 27, text: "æœ‰æ—¶å¯¹äººå†·æ·¡çš„äºº", dimension: "A", reverse: true },
            { id: 28, text: "åšæŒä¸æ‡ˆç›´åˆ°ä»»åŠ¡å®Œæˆçš„äºº", dimension: "C", reverse: false },
            { id: 29, text: "æƒ…ç»ªå¤šå˜çš„äºº", dimension: "N", reverse: false },
            { id: 30, text: "é‡è§†è‰ºæœ¯å’Œå®¡ç¾ä½“éªŒçš„äºº", dimension: "O", reverse: false },
            { id: 31, text: "æœ‰æ—¶å®³ç¾ã€æ‹˜è°¨çš„äºº", dimension: "E", reverse: true },
            { id: 32, text: "å¯¹å‡ ä¹æ‰€æœ‰äººéƒ½ä½“è´´ã€å‹å–„çš„äºº", dimension: "A", reverse: false },
            { id: 33, text: "åšäº‹æœ‰æ•ˆç‡çš„äºº", dimension: "C", reverse: false },
            { id: 34, text: "åœ¨ç´§å¼ æƒ…å¢ƒä¸‹èƒ½ä¿æŒå†·é™çš„äºº", dimension: "N", reverse: true },
            { id: 35, text: "å–œæ¬¢æŒ‰å¸¸è§„åšäº‹çš„äºº", dimension: "O", reverse: true },
            { id: 36, text: "å¤–å‘ã€å–„äºç¤¾äº¤çš„äºº", dimension: "E", reverse: false },
            { id: 37, text: "æœ‰æ—¶å¯¹ä»–äººç²—é²çš„äºº", dimension: "A", reverse: true },
            { id: 38, text: "åšäº‹æœ‰è®¡åˆ’å¹¶èƒ½è´¯å½»æ‰§è¡Œçš„äºº", dimension: "C", reverse: false },
            { id: 39, text: "å®¹æ˜“ç´§å¼ çš„äºº", dimension: "N", reverse: false },
            { id: 40, text: "å–œæ¬¢æ€è€ƒã€ç¢ç£¨å„ç§æƒ³æ³•çš„äºº", dimension: "O", reverse: false },
            { id: 41, text: "å¯¹è‰ºæœ¯å…´è¶£ä¸å¤§çš„äºº", dimension: "O", reverse: true },
            { id: 42, text: "å–œæ¬¢ä¸ä»–äººåˆä½œçš„äºº", dimension: "A", reverse: false },
            { id: 43, text: "å®¹æ˜“åˆ†å¿ƒçš„äºº", dimension: "C", reverse: true },
            { id: 44, text: "åœ¨è‰ºæœ¯ã€éŸ³ä¹æˆ–æ–‡å­¦æ–¹é¢æœ‰è¾ƒé«˜ä¿®å…»çš„äºº", dimension: "O", reverse: false }
        ];

        const dimensionInfo = {
            O: {
                name: "å¼€æ”¾æ€§",
                english: "Openness",
                icon: "ğŸ¨",
                count: 10,
                high: "ä½ å¯Œæœ‰æƒ³è±¡åŠ›å’Œåˆ›é€ åŠ›ï¼Œå¯¹æ–°äº‹ç‰©å……æ»¡å¥½å¥‡ï¼Œå–œæ¬¢æ¢ç´¢ä¸åŒçš„è§‚ç‚¹å’Œä½“éªŒã€‚ä½ æ¬£èµè‰ºæœ¯å’Œç¾ï¼Œæ€ç»´æ´»è·ƒä¸”ä¸æ‹˜ä¸€æ ¼ã€‚",
                medium: "ä½ åœ¨ä¼ ç»Ÿä¸åˆ›æ–°ä¹‹é—´ä¿æŒå¹³è¡¡ï¼Œæ—¢èƒ½æ¥å—æ–°äº‹ç‰©ï¼Œä¹Ÿé‡è§†å·²æœ‰çš„ç»éªŒå’Œæ–¹æ³•ã€‚",
                low: "ä½ åŠ¡å®ã€è„šè¸å®åœ°ï¼Œåå¥½ç†Ÿæ‚‰å’Œå¯é¢„æµ‹çš„äº‹ç‰©ã€‚ä½ é‡è§†ä¼ ç»Ÿå’Œå¸¸è§„ï¼Œåšäº‹ç¨³å¥å¯é ã€‚",
                career: { high: "åˆ›æ„è®¾è®¡ã€è‰ºæœ¯ã€ç ”ç©¶ã€å’¨è¯¢ã€åˆ›ä¸š", medium: "å¸‚åœºè¥é”€ã€äº§å“ç»ç†ã€æ•™è‚²", low: "è´¢åŠ¡ã€è¡Œæ”¿ã€å·¥ç¨‹ã€è´¨é‡ç®¡ç†" },
                love: { high: "ä½ æ¸´æœ›ç²¾ç¥å±‚é¢çš„æ·±åº¦è¿æ¥ï¼Œå–œæ¬¢ä¸ä¼´ä¾£åˆ†äº«æ–°å¥‡ä½“éªŒå’Œæ·±åº¦å¯¹è¯ã€‚", medium: "ä½ åœ¨å…³ç³»ä¸­æ—¢è¿½æ±‚æ–°é²œæ„Ÿï¼Œä¹Ÿé‡è§†ç¨³å®šæ€§ã€‚", low: "ä½ é‡è§†å…³ç³»çš„ç¨³å®šå’Œå¯é¢„æµ‹æ€§ï¼Œæ˜¯å¯é çš„é•¿æœŸä¼´ä¾£ã€‚" }
            },
            C: {
                name: "å°½è´£æ€§",
                english: "Conscientiousness",
                icon: "ğŸ“‹",
                count: 9,
                high: "ä½ è‡ªå¾‹ã€æœ‰æ¡ç†ã€åšäº‹è®¤çœŸè´Ÿè´£ã€‚ä½ å–„äºåˆ¶å®šè®¡åˆ’å¹¶åšæŒæ‰§è¡Œï¼Œè¿½æ±‚å“è¶Šï¼Œæ˜¯å€¼å¾—ä¿¡èµ–çš„äººã€‚",
                medium: "ä½ åœ¨çµæ´»æ€§å’Œæ¡ç†æ€§ä¹‹é—´å–å¾—å¹³è¡¡ï¼Œèƒ½å¤Ÿæ ¹æ®æƒ…å†µè°ƒæ•´è‡ªå·±çš„å·¥ä½œæ–¹å¼ã€‚",
                low: "ä½ çµæ´»éšæ€§ï¼Œä¸å–œæ¬¢è¢«è§„åˆ™æŸç¼šã€‚ä½ æ›´æ³¨é‡å½“ä¸‹çš„ä½“éªŒï¼Œè€Œéé•¿è¿œçš„è®¡åˆ’ã€‚",
                career: { high: "é¡¹ç›®ç®¡ç†ã€åŒ»ç–—ã€æ³•å¾‹ã€é‡‘èã€ç§‘ç ”", medium: "é”€å”®ã€äººåŠ›èµ„æºã€è¿è¥", low: "è‰ºæœ¯åˆ›ä½œã€è‡ªç”±èŒä¸šã€åˆ›æ„è¡Œä¸š" },
                love: { high: "ä½ æ˜¯å¯é çš„ä¼´ä¾£ï¼Œä¼šè®¤çœŸç»è¥å…³ç³»ï¼Œä½†å¯èƒ½éœ€è¦å­¦ä¼šæ”¾æ¾å’Œäº«å—å½“ä¸‹ã€‚", medium: "ä½ åœ¨å…³ç³»ä¸­æ—¢è´Ÿè´£ä»»åˆä¿æŒä¸€å®šçš„çµæ´»æ€§ã€‚", low: "ä½ ä¸ºå…³ç³»å¸¦æ¥è‡ªå‘æ€§å’Œä¹è¶£ï¼Œä½†å¯èƒ½éœ€è¦åœ¨æ‰¿è¯ºæ–¹é¢æ›´åŠ ç”¨å¿ƒã€‚" }
            },
            E: {
                name: "å¤–å‘æ€§",
                english: "Extraversion",
                icon: "ğŸ‰",
                count: 8,
                high: "ä½ çƒ­æƒ…å¼€æœ—ã€å–„äºç¤¾äº¤ï¼Œä»ä¸äººäº’åŠ¨ä¸­è·å¾—èƒ½é‡ã€‚ä½ å–œæ¬¢æˆä¸ºå…³æ³¨çš„ç„¦ç‚¹ï¼Œå……æ»¡æ´»åŠ›å’Œæ„ŸæŸ“åŠ›ã€‚",
                medium: "ä½ èƒ½å¤Ÿåœ¨ç¤¾äº¤å’Œç‹¬å¤„ä¹‹é—´çµæ´»åˆ‡æ¢ï¼Œæ—¢äº«å—ä¸äººäº¤å¾€ï¼Œä¹Ÿéœ€è¦ä¸ªäººç©ºé—´ã€‚",
                low: "ä½ å†…æ•›æ²‰ç¨³ï¼Œåå¥½æ·±åº¦çš„ä¸€å¯¹ä¸€äº¤æµè€Œéå¤§å‹ç¤¾äº¤åœºåˆã€‚ä½ åœ¨ç‹¬å¤„ä¸­å……ç”µï¼Œæ€è€ƒæ·±å…¥ã€‚",
                career: { high: "é”€å”®ã€å…¬å…³ã€åŸ¹è®­ã€ç®¡ç†ã€æ¼”è‰º", medium: "å’¨è¯¢ã€äº§å“ã€å¸‚åœº", low: "ç ”å‘ã€å†™ä½œã€åˆ†æã€æŠ€æœ¯" },
                love: { high: "ä½ åœ¨å…³ç³»ä¸­çƒ­æƒ…ä¸»åŠ¨ï¼Œå–œæ¬¢ä¸°å¯Œçš„ç¤¾äº¤ç”Ÿæ´»ï¼Œéœ€è¦æ‰¾åˆ°åŒæ ·å¤–å‘æˆ–ç†è§£ä½ çš„ä¼´ä¾£ã€‚", medium: "ä½ åœ¨å…³ç³»ä¸­æ—¢èƒ½çƒ­æƒ…æŠ•å…¥ï¼Œä¹Ÿèƒ½ç»™å¯¹æ–¹ç©ºé—´ã€‚", low: "ä½ åœ¨å…³ç³»ä¸­æ·±æ²‰ä¸“æ³¨ï¼Œé‡è§†è´¨é‡è€Œéæ•°é‡ï¼Œæ˜¯å¿ è¯šçš„ä¼´ä¾£ã€‚" }
            },
            A: {
                name: "å®œäººæ€§",
                english: "Agreeableness",
                icon: "ğŸ¤",
                count: 9,
                high: "ä½ å‹å–„ã€å¯Œæœ‰åŒç†å¿ƒã€ä¹äºåŠ©äººã€‚ä½ é‡è§†å’Œè°çš„äººé™…å…³ç³»ï¼Œå–„äºåˆä½œï¼Œå®¹æ˜“ä¿¡ä»»ä»–äººã€‚",
                medium: "ä½ åœ¨åˆä½œä¸ç«äº‰ä¹‹é—´ä¿æŒå¹³è¡¡ï¼Œæ—¢èƒ½ä½“è°…ä»–äººï¼Œä¹Ÿèƒ½åšæŒè‡ªå·±çš„ç«‹åœºã€‚",
                low: "ä½ ç‹¬ç«‹ã€ç›´æ¥ã€æœ‰ç«äº‰æ„è¯†ã€‚ä½ æ›´å…³æ³¨æ•ˆç‡å’Œç»“æœï¼Œä¸ä¼šä¸ºäº†å–æ‚¦ä»–äººè€Œå¦¥åã€‚",
                career: { high: "æŠ¤ç†ã€ç¤¾å·¥ã€æ•™è‚²ã€å®¢æœã€äººåŠ›èµ„æº", medium: "äº§å“ã€è¿è¥ã€å’¨è¯¢", low: "æ³•å¾‹ã€è°ˆåˆ¤ã€ç®¡ç†ã€åˆ›ä¸š" },
                love: { high: "ä½ æ˜¯ä½“è´´å…¥å¾®çš„ä¼´ä¾£ï¼Œä½†è¦æ³¨æ„ä¸è¦è¿‡åº¦ç‰ºç‰²è‡ªå·±çš„éœ€æ±‚ã€‚", medium: "ä½ åœ¨å…³ç³»ä¸­æ—¢èƒ½ç…§é¡¾å¯¹æ–¹ï¼Œä¹Ÿèƒ½è¡¨è¾¾è‡ªå·±çš„éœ€æ±‚ã€‚", low: "ä½ åœ¨å…³ç³»ä¸­ç›´æ¥å¦è¯šï¼Œéœ€è¦æ‰¾åˆ°æ¬£èµä½ ç‹¬ç«‹æ€§çš„ä¼´ä¾£ã€‚" }
            },
            N: {
                name: "ç¥ç»è´¨",
                english: "Neuroticism",
                icon: "ğŸŒŠ",
                count: 8,
                high: "ä½ æƒ…æ„Ÿä¸°å¯Œã€æ•æ„Ÿç»†è…»ï¼Œå®¹æ˜“æ„Ÿå—åˆ°å‹åŠ›å’Œè´Ÿé¢æƒ…ç»ªã€‚è¿™ç§æ•æ„Ÿæ€§ä¹Ÿè®©ä½ æ›´èƒ½ç†è§£ä»–äººçš„æ„Ÿå—ã€‚",
                medium: "ä½ çš„æƒ…ç»ªç›¸å¯¹ç¨³å®šï¼Œä½†åœ¨å‹åŠ›ä¸‹ä¹Ÿä¼šæœ‰æ‰€æ³¢åŠ¨ï¼Œè¿™æ˜¯æ­£å¸¸çš„æƒ…ç»ªååº”ã€‚",
                low: "ä½ æƒ…ç»ªç¨³å®šã€å†·é™ä»å®¹ï¼Œèƒ½å¤Ÿå¾ˆå¥½åœ°åº”å¯¹å‹åŠ›å’ŒæŒ‘æˆ˜ã€‚ä½ å¾ˆå°‘è¢«è´Ÿé¢æƒ…ç»ªå›°æ‰°ã€‚",
                career: { high: "è‰ºæœ¯åˆ›ä½œã€å¿ƒç†å’¨è¯¢ã€å†™ä½œï¼ˆéœ€è¦æƒ…ç»ªç®¡ç†ï¼‰", medium: "å¤§å¤šæ•°èŒä¸šéƒ½é€‚åˆ", low: "å±æœºç®¡ç†ã€æ€¥æ•‘ã€é¢†å¯¼å²—ä½ã€é«˜å‹ç¯å¢ƒ" },
                love: { high: "ä½ åœ¨å…³ç³»ä¸­æƒ…æ„ŸæŠ•å…¥æ·±ï¼Œéœ€è¦ä¼´ä¾£çš„ç†è§£å’Œæ”¯æŒï¼Œå­¦ä¼šæƒ…ç»ªè°ƒèŠ‚ä¼šè®©å…³ç³»æ›´å¥åº·ã€‚", medium: "ä½ åœ¨å…³ç³»ä¸­æƒ…ç»ªè¡¨è¾¾é€‚åº¦ï¼Œèƒ½å¤Ÿå¤„ç†å¤§å¤šæ•°å†²çªã€‚", low: "ä½ ä¸ºå…³ç³»å¸¦æ¥ç¨³å®šæ„Ÿï¼Œä½†è¦æ³¨æ„ä¸è¦å¿½è§†ä¼´ä¾£çš„æƒ…æ„Ÿéœ€æ±‚ã€‚" }
            }
        };

        let currentQuestion = 0;
        let answers = {};

        function init() {
            loadHistory();
            document.getElementById('welcomeContainer').style.display = 'block';
        }

        function loadHistory() {
            const history = JSON.parse(localStorage.getItem('bfi44_history') || '[]');
            const historyCard = document.getElementById('historyCard');
            const historyList = document.getElementById('historyList');
            
            if (history.length > 0) {
                historyCard.style.display = 'block';
                historyList.innerHTML = history.slice(0, 5).map((item, index) => `
                    <div class="history-item" onclick="viewHistory(${index})">
                        <div>
                            <div class="history-date">${item.date}</div>
                            <div class="history-preview">E:${item.scores.E} A:${item.scores.A} C:${item.scores.C} N:${item.scores.N} O:${item.scores.O}</div>
                        </div>
                        <span class="history-arrow">â†’</span>
                    </div>
                `).join('');
            }
        }

        function viewHistory(index) {
            const history = JSON.parse(localStorage.getItem('bfi44_history') || '[]');
            if (history[index]) {
                showResults(history[index].scores, history[index].date);
            }
        }

        function startTest() {
            document.getElementById('welcomeContainer').style.display = 'none';
            document.getElementById('testContainer').style.display = 'block';
            currentQuestion = 0;
            answers = {};
            renderQuestion();
        }

        function renderQuestion() {
            const q = questions[currentQuestion];
            document.getElementById('questionNumber').textContent = `Q${currentQuestion + 1}`;
            document.getElementById('questionText').textContent = q.text;
            
            // Update progress
            const progress = ((currentQuestion) / questions.length) * 100;
            document.getElementById('progressFill').style.width = `${progress}%`;
            document.getElementById('progressText').textContent = `ç¬¬ ${currentQuestion + 1} é¢˜ / å…± ${questions.length} é¢˜`;
            document.getElementById('progressPercent').textContent = `${Math.round(progress)}%`;
            
            // Reset options
            document.querySelectorAll('.option').forEach(opt => {
                opt.classList.remove('selected');
            });
            
            // Restore previous answer if exists
            if (answers[currentQuestion] !== undefined) {
                const selectedOption = document.querySelector(`.option[data-value="${answers[currentQuestion]}"]`);
                if (selectedOption) {
                    selectedOption.classList.add('selected');
                }
                document.getElementById('nextBtn').disabled = false;
            } else {
                document.getElementById('nextBtn').disabled = true;
            }
            
            // Update prev button
            document.getElementById('prevBtn').disabled = currentQuestion === 0;
            
            // Update next button text
            document.getElementById('nextBtn').textContent = currentQuestion === questions.length - 1 ? 'æŸ¥çœ‹ç»“æœ' : 'ä¸‹ä¸€é¢˜';
        }

        function selectOption(element) {
            document.querySelectorAll('.option').forEach(opt => {
                opt.classList.remove('selected');
            });
            element.classList.add('selected');
            answers[currentQuestion] = parseInt(element.dataset.value);
            document.getElementById('nextBtn').disabled = false;
            
            if (currentQuestion < questions.length - 1) {
                setTimeout(function() {
                    nextQuestion();
                }, 300);
            } else {
                setTimeout(function() {
                    calculateAndShowResults();
                }, 300);
            }
        }

        function nextQuestion() {
            if (currentQuestion < questions.length - 1) {
                currentQuestion++;
                renderQuestion();
                document.getElementById('questionCard').classList.remove('fade-in');
                void document.getElementById('questionCard').offsetWidth;
                document.getElementById('questionCard').classList.add('fade-in');
            } else {
                calculateAndShowResults();
            }
        }

        function prevQuestion() {
            if (currentQuestion > 0) {
                currentQuestion--;
                renderQuestion();
            }
        }

        function calculateAndShowResults() {
            const scores = { O: 0, C: 0, E: 0, A: 0, N: 0 };
            const counts = { O: 0, C: 0, E: 0, A: 0, N: 0 };
            
            questions.forEach((q, index) => {
                if (answers[index] !== undefined) {
                    let score = answers[index];
                    if (q.reverse) {
                        score = 6 - score;
                    }
                    scores[q.dimension] += score;
                    counts[q.dimension]++;
                }
            });
            
            // Calculate percentages (1-5 scale to 0-100)
            Object.keys(scores).forEach(dim => {
                const maxScore = counts[dim] * 5;
                const minScore = counts[dim] * 1;
                scores[dim] = Math.round(((scores[dim] - minScore) / (maxScore - minScore)) * 100);
            });
            
            // Save to history
            const date = new Date().toLocaleString('zh-CN', {
                year: 'numeric',
                month: '2-digit',
                day: '2-digit',
                hour: '2-digit',
                minute: '2-digit'
            });
            
            const history = JSON.parse(localStorage.getItem('bfi44_history') || '[]');
            history.unshift({ date, scores, answers: {...answers} });
            if (history.length > 10) history.pop();
            localStorage.setItem('bfi44_history', JSON.stringify(history));
            
            showResults(scores, date);
        }

        function getLevel(score) {
            if (score >= 60) return { text: 'åé«˜', class: 'level-high' };
            if (score >= 40) return { text: 'ä¸­ç­‰', class: 'level-medium' };
            return { text: 'åä½', class: 'level-low' };
        }

        function getDescription(dim, score) {
            const info = dimensionInfo[dim];
            if (score >= 60) return info.high;
            if (score >= 40) return info.medium;
            return info.low;
        }

        function getCareer(dim, score) {
            const info = dimensionInfo[dim];
            if (score >= 60) return info.career.high;
            if (score >= 40) return info.career.medium;
            return info.career.low;
        }

        function getLove(dim, score) {
            const info = dimensionInfo[dim];
            if (score >= 60) return info.love.high;
            if (score >= 40) return info.love.medium;
            return info.love.low;
        }

        function showResults(scores, date) {
            document.getElementById('testContainer').style.display = 'none';
            document.getElementById('welcomeContainer').style.display = 'none';
            document.getElementById('resultsContainer').style.display = 'block';
            
            const dims = ['E', 'A', 'C', 'N', 'O'];
            const sortedDims = [...dims].sort((a, b) => scores[b] - scores[a]);
            const highest = sortedDims[0];
            const lowest = sortedDims[sortedDims.length - 1];
            
            let html = `
                <div class="results-header fade-in">
                    <h2>ğŸ‰ æµ‹è¯•å®Œæˆï¼</h2>
                    <p>ä»¥ä¸‹æ˜¯ä½ çš„å¤§äº”äººæ ¼åˆ†ææŠ¥å‘Š</p>
                    <div class="results-date">æµ‹è¯•æ—¶é—´ï¼š${date}</div>
                </div>
                
                <div class="summary-card fade-in">
                    <h3>ğŸ“Š æ ¸å¿ƒå‘ç°</h3>
                    <div class="summary-item">
                        <span class="summary-icon">${dimensionInfo[highest].icon}</span>
                        <div class="summary-text">
                            <div class="summary-label">æœ€çªå‡ºç‰¹è´¨</div>
                            <div class="summary-value">${dimensionInfo[highest].name} (${scores[highest]}%)</div>
                        </div>
                    </div>
                    <div class="summary-item">
                        <span class="summary-icon">${dimensionInfo[lowest].icon}</span>
                        <div class="summary-text">
                            <div class="summary-label">ç›¸å¯¹è¾ƒä½</div>
                            <div class="summary-value">${dimensionInfo[lowest].name} (${scores[lowest]}%)</div>
                        </div>
                    </div>
                    <div class="summary-item">
                        <span class="summary-icon">ğŸ’¼</span>
                        <div class="summary-text">
                            <div class="summary-label">æ¨èèŒä¸šæ–¹å‘</div>
                            <div class="summary-value">${getCareer(highest, scores[highest]).split('ã€')[0]}</div>
                        </div>
                    </div>
                </div>
            `;
            
            dims.forEach(dim => {
                const info = dimensionInfo[dim];
                const score = scores[dim];
                const level = getLevel(score);
                
                html += `
                    <div class="dimension-card fade-in">
                        <div class="dimension-header">
                            <div class="dimension-icon ${dim}">${info.icon}</div>
                            <div class="dimension-title">
                                <h3>${info.name}</h3>
                                <span>${info.english}</span>
                            </div>
                            <div class="dimension-score">
                                <div class="score-value">${score}</div>
                                <div class="score-label">/ 100</div>
                            </div>
                        </div>
                        
                        <div class="score-bar">
                            <div class="score-fill ${dim}" style="width: ${score}%"></div>
                        </div>
                        
                        <span class="dimension-level ${level.class}">${level.text}</span>
                        
                        <p class="dimension-desc">${getDescription(dim, score)}</p>
                        
                        <div class="analysis-section">
                            <div class="analysis-title">ğŸ’¼ èŒä¸šå»ºè®®</div>
                            <div class="analysis-content">${getCareer(dim, score)}</div>
                            <div class="analysis-tags">
                                ${getCareer(dim, score).split('ã€').map(c => `<span class="tag">${c}</span>`).join('')}
                            </div>
                        </div>
                        
                        <div class="analysis-section">
                            <div class="analysis-title">ğŸ’• å©šæ‹æ´å¯Ÿ</div>
                            <div class="analysis-content">${getLove(dim, score)}</div>
                        </div>
                    </div>
                `;
            });
            
            html += `
                <div class="action-buttons">
                    <button class="btn-outline" onclick="retakeTest()">é‡æ–°æµ‹è¯•</button>
                    <button class="btn-outline" onclick="shareResults()">åˆ†äº«ç»“æœ</button>
                </div>
            `;
            
            document.getElementById('resultsContainer').innerHTML = html;
            window.scrollTo({ top: 0, behavior: 'smooth' });
        }

        function retakeTest() {
            document.getElementById('resultsContainer').style.display = 'none';
            document.getElementById('welcomeContainer').style.display = 'block';
            loadHistory();
            window.scrollTo({ top: 0, behavior: 'smooth' });
        }

        function shareResults() {
            const text = 'æˆ‘åˆšå®Œæˆäº†å¤§äº”äººæ ¼æµ‹è¯•ï¼Œæ¥æµ‹æµ‹ä½ çš„äººæ ¼ç‰¹è´¨å§ï¼';
            if (navigator.share) {
                navigator.share({
                    title: 'å¤§äº”äººæ ¼æµ‹è¯•',
                    text: text,
                    url: window.location.href
                });
            } else {
                navigator.clipboard.writeText(text + ' ' + window.location.href).then(() => {
                    alert('é“¾æ¥å·²å¤åˆ¶åˆ°å‰ªè´´æ¿ï¼');
                });
            }
        }

        // Initialize
        init();
    </script>
</body>
</html>